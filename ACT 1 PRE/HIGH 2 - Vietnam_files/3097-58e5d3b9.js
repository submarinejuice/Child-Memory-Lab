(self.webpackChunknatgeo=self.webpackChunknatgeo||[]).push([[3097],{1984:(e,t,a)=>{var n,r=a(85893),c=(a(67294),a(3896)),i=a(50239),o=a(5902),s=a(45697),l=a(34248).PropTypes,p=a(34248),_=a(64535),d=a(29643),m=a(65581),u=a(21283),y=a(74055),g=a(43881),h=a(26278),j=h.getEmailWallCookie,x=h.getLoginValueCookie,b=h.getMeteringCountCookie,M=a(359),O=a(94184),T=a(14461),f=a(24213),P=a(35215),w=a(7877),v=a(27361),N=i.emptyObj,k=i.cbool,E=i.empty,A=i.isFunc,C=i.isNum,I=i.noop,D=i.passThru,L=i.FALSE,S=i.TRUE,R=i.NULL,U=i.UNDEF,V="context.translate",F="userConfig.meteringDisplay.count",Y=[{cropName:"raw",width:300}],B=M.LINK_TRACK_VALUES.PAYWALL_METER,W=B.EVENT_NAME,H=B.COLLAPSE,K=B.EXPAND,Q=M.COMMON_ANALYTICS.CUSTOM_EVENT,z=" left",X="metered toast";a(40963),(n=c({displayName:"PaywallMeter",componentDidMount:function(){var e=this,t=e.props||N,a=t.campaignName,n=v(e,"context.analytics.track")||I,r=v(e,"state.hasFiredImpression");e._disposer=p.reaction((function(){return v(t,F)}),(function(t){C(t)&&!r&&(w.track||(w.track=n),w.add(Q,{event_name:"".concat("paywall meter impressions ").concat(t+1).concat(z),paywall_type:X,campaign_name:a}),e.setState({clickTrackName:"".concat("paywall meter click ").concat(t+1).concat(z),hasFiredImpression:S}))})),o.emit("paywall_meter_on")},componentWillUnmount:function(){this._disposer=U},getInitialState:function(){return{clickTrackName:R,expanded:S,hasFiredImpression:L}},togglePaywall:function(){var e=this||N,t=(e.state||N).expanded;e.setState({expanded:!t})},render:function(){var e,t=this||N,a=v(t,V,D),n=t.props||N,c=t.state||N,i=c.expanded,o=c.clickTrackName,s=i?"paywall.meter.collapse":"paywall.meter.expand",l=n.image||N,p=l.altText||"",h=n.heading||"",M=n.description||"",T=n.cta||N,f=T.url||"",P=T.text||"",w=n.campaignName,C=n.optimizeImage,I=v(n,F),L=k(j()),S=b(),U=k(x()),B=t.getMeteringDisplayText(I),Q=i?"".concat(W," ").concat(H):"".concat(W," ").concat(K),z=O("PaywallMeter__container",{"PaywallMeter--expanded":i,"PaywallMeter--collapsed":!i}),q=r.jsx(_,{label:P,link:T,type:"link"});return U||L||S?(o&&(q=r.jsx(d,{"data-track-event_name":o,"data-track-paywall_type":X,"data-track-campaign_name":w,children:q})),!E(l)&&A(C)&&(e=C(l,Y)),r.jsx("div",{className:"PaywallMeter",children:r.jsxs("div",{className:z,children:[r.jsxs("div",{className:"PaywallMeter__Top",children:[r.jsxs("div",{className:"PaywallMeter__Top__Title",children:[B?r.jsx(g,{className:"PaywallMeter__Top__CounterText",text:B,element:"div"},I):R,r.jsx(d,{"data-track-event_name":Q,"data-track-custom":"yes","data-track-paywall_type":Q,"data-track-campaign_name":w,children:r.jsx("button",{className:"PaywallMeter__Top__Icon","aria-label":a(s),onClick:t.togglePaywall,"aria-expanded":i,children:r.jsx(u,{icon:"caret__down",className:"PaywallMeter__Top__Icon__Caret",ariaHidden:"true"})})})]}),r.jsx("div",{className:"PaywallMeter__Top__CollapsedLabel",children:r.jsx(y,{to:f,target:"_self",className:"PaywallMeter__Top__CollapsedAnchor",children:P})})]}),r.jsxs("div",{className:"PaywallMeter__Body",children:[e&&r.jsx(m,{className:"PaywallMeter__Body__Image",src:e,alt:p,ratio:"auto"}),r.jsx("h2",{className:"PaywallMeter__Body__Heading",children:h}),r.jsx("span",{className:"PaywallMeter__Body__Description",children:M}),r.jsx("div",{className:"PaywallMeter__Body__CallToAction",children:q})]})]})})):R},getMeteringDisplayText:function(e){var t=v(this||N,V,D);return 0===e?t("article.lastFreeArticleText"):C(e)?t("article.meterText",{count:e+1}):"fallback"===e?t("article.meterText.fallback"):void 0}})).propTypes={analyticsData:s.object,image:l.objectOrObservableObject,heading:s.string,description:s.string,cta:l.objectOrObservableObject},n.contextTypes={analytics:s.object,translate:s.func},n.defaultProps={analyticsData:{},image:{},heading:"",description:"",cta:{}},e.exports=f(T(P(n)),["app","user"])},68258:(e,t,a)=>{e.exports=a(1984)},65570:(e,t,a)=>{var n=a(38416),r=a(85893);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a(67294);var o,s=a(3896),l=a(50239),p=a(84967),_=a(45697),d=a(27361),m=a(38169),u=a(74055),y=a(59950),g=a(359),h=a(26278),j=a(21800),x=h.getLoginValueCookie,b=g.COMMON_ANALYTICS.CUSTOM_EVENT,M=l.empty,O=l.emptyObj,T=l.emptyAry,f=l.noop,P=l.strlc,w=l.cbool,v="context.analytics.track",N="truncation message";a(79730),(o=s({displayName:"TruncationMessage",render:function(){var e,t=this,a=t.props||O,n=t.trackLink,c=a.campaignName,o=a.title,s=a.subtitle,l=a.firstText,p=a.secondText,_=a.ctas||T,d=_.length>0?_[0]:O,g=d.text,h=d.url||"#",b=d.useOneID,f=w(x()),v=_.length>1?_[1]:O,k=v.text,E=v.useOneID,A=v.url||"#",C=t.onView,I={},D={},L={event_name:"truncation message click",campaign_name:c,paywall_type:N},S=j({},L,{event_detail:P(g)}),R=j({},L,{event_detail:P(k)});return I.onClick=b?m(n,null,S,!0):m(n,null,S,!1,h),D.onClick=E?m(n,null,R,!0):m(n,null,R,!1,A),e=!p||M(v)||f?r.jsxs("div",{className:"TruncatedMessage__Footer",children:[r.jsx(u,i(i({},I),{},{children:g})),l]}):r.jsxs("div",{className:"TruncatedMessage__Footer",children:[r.jsx(u,i(i({},I),{},{children:g})),l,"Â ",p,r.jsx(u,i(i({},D),{},{children:k}))]}),r.jsx(y,{onEnter:C,threshold:-200,children:r.jsxs("div",{className:"TruncatedMessage",children:[r.jsx("div",{className:"TruncatedMessage__Title",children:o}),r.jsx("div",{className:"TruncatedMessage__Subtitle",children:s}),e]})})},onView:function(e){var t=this,a=(t.props||O).campaignName,n=d(t,v,l.noop);(t.state||O).wasSeen||t.setState({photosSeen:!0},n(b,{event_name:"article truncate",campaign_name:a,paywall_type:N}))},trackLink:function(e,t,a){var n=this,r=(n.props||O).campaignName,c=d(n,"context.guest.disneyInstance.launchIdentityFlow",f),i=d(n,v,f);M(e)||i(b,e),t?(i(b,{event_name:"oneid action",event_detail:"oneid modal displayed",campaign_name:r,paywall_type:N}),c()):a&&p.loc(a)},getInitialState:function(){return{wasSeen:!1}}})).contextTypes={guest:_.object,analytics:_.object},o.propTypes={title:_.string,subtitle:_.string,footer:_.string},e.exports=o},39754:(e,t,a)=>{e.exports=a(65570)},28891:(e,t,a)=>{e.exports=a(10526)},10526:(e,t,a)=>{var n=a(38416),r=a(85893);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}a(67294);var i,o=a(13311),s=a(27361),l=a(3896),p=a(50239),_=a(5902),d=a(11227)("natgeo:metering"),m=a(24213),u=a(29234),y=a(70485),g=y.TYPE,h=s(y,"PROP_NAMES.CMS_ID"),j=a(10238),x=j.TYPE,b=s(j,"PROP_NAMES.CONTENT_ID"),M=a(26278),O=M.getEmailWallCookie,T=M.getMeteringCountCookie,f=M.setEmailWallCookie,P=M.getLoginValueCookie,w=p.cbool,v=p.idxOf,N=p.emptyObj,k=p.TRUE,E=a(24849),A=E.ACQ_EMAIL_PARAM,C=E.ACQ_EMAIL_PARAM_VALUE,I=E.CRM_EMAIL_PARAM,D=E.CRM_EMAIL_PARAM_VALUE,L=E.EMAIL_PARAM_KEY,S=a(16031).POLICY_ID_BY_API_ENV,R=a(50523).PROP_NAMES,U=R.UTILITY_DATA.IS_METERED,V=R.UTILITY_DATA.IS_USER_AUTHED,F="locationConfig.params",Y={};Y[g]=h,Y[x]=b,e.exports=function(e){return i=l({displayName:"withMetering",checkMeteredContent:function(){var e=this.props||N,t=s(e,"appConfig.apiEnv"),a=S[t],n=e[U],r=e[V],c=e.cmsType,i=e[Y[c]||"id"],o=s(e,F,N),l=o.enable,p=o._version,_=e.userConfig,m={enable:l,itemId:i,policyId:a,_version:p};d("Metering Policy",a),n&&!r&&u(m,_)},componentDidMount:function(){var e=this,t=e.props||N,a=s(t,F,N),n=w(O()),r=T(),c=w(P()),i=w(o(a,(function(e,t){var a=v(e,A)>-1||t===L&&e===C,n=v(e,I)>-1||t===L&&e===D;return a||n}))),l=n||c||i;i&&f(k),l||r?e.checkMeteredContent():_.on("natgeo_newsletters_close",(function(){w(O())&&e.checkMeteredContent()}))},render:function(){var t=this.props||N;return r.jsx(e,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t))}}),m(i,["app","location","user"])}},40963:(e,t,a)=>{"use strict";a.r(t)},79730:(e,t,a)=>{"use strict";a.r(t)}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3344],{76319:function(e,t,l){l(83079);var a=l(12119);t.Z=(0,a.$)("1d653343290310cd32fcea0ded2a4b9e3caab56f")},24978:function(e,t,l){var a=l(57437),o=l(39857),i=l(33145),c=l(94315),s=l(36760),r=l.n(s),n=l(77165);t.Z=e=>{let{page:t,onClose:l,type:s}=e,{title:d,subtitle:u,__typename:f,type:m,recordType:p}=t,h=p||f||m,x="GlossaryItemRecord"===h,v="TopicRecord"===h||"ConceptRecord"===h,g=t.cardImage||t.image;return(0,a.jsxs)("div",{className:"SignInModal relative z-30",children:[(0,a.jsx)(o.E.div,{initial:{opacity:0},animate:{opacity:.75},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-[#001430] transition-opacity brightness-50"}),(0,a.jsx)("div",{className:"modal-content fixed inset-0 z-40 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full justify-center p-4 text-center items-center md:p-0 w-full",children:(0,a.jsx)(o.E.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0},transition:{duration:.2},className:r()("max-w-[600px] w-full mx-auto",{"!max-w-[800px]":!x}),children:(0,a.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all my-20 p-5 md:p-8 lg:pt-12",children:[(0,a.jsx)("button",{onClick:e=>l(e),"aria-label":"close",className:"absolute group right-3 top-3 text-blue",children:(0,a.jsx)(n.Z,{className:"h-8 w-8 stroke-text-grey group-hover:stroke-2"})}),(0,a.jsxs)("div",{className:"flex flex-row gap-10",children:[!x&&!v&&(0,a.jsx)("div",{className:"ArticleCard flex flex-col items-start hidden sm:block max-w-[350px] w-full rounded-lg overflow-hidden shadow-md not-prose transition-shadow bg-off-white",children:(0,a.jsxs)("div",{className:"flex flex-1 flex-col min-h-[325px] relative",children:[g&&(0,a.jsx)("div",{className:"w-full aspect-[2/1] relative",children:(0,a.jsx)(i.default,{alt:g.alt,src:g.url,fill:!0,className:"w-full max-w-2xl object-cover",placeholder:g.blurUpThumb?"blur":"empty",blurDataURL:g.blurUpThumb})}),(0,a.jsxs)("div",{className:"p-5 relative",children:[(0,a.jsx)("h4",{className:"text-sm text-blue mb-2.5 uppercase",children:u}),(0,a.jsx)("h3",{className:"h4 mb-3 line-clamp-3",children:d})]})]})}),v&&(0,a.jsxs)("div",{className:"rounded-md relative overflow-hidden bg-black w-full block h-[170px]",children:[g&&(0,a.jsx)(i.default,{src:g.url,width:g.width,height:g.height,alt:g.alt||d,className:"absolute h-full w-full object-cover",blurDataURL:g.blurUpThumb,placeholder:g.blurUpThumb?"blur":"empty"}),(0,a.jsxs)("div",{className:"px-5 py-4 z-20 relative h-full flex justify-end flex-col bg-gradient-to-t from-[rgba(0,0,0,0.8)] to-[rgba(0,0,0,0.1)]",children:[(0,a.jsx)("p",{className:"uppercase group-hover:text-blue text-white mb-2 text-sm font-bold leading-4",children:u}),(0,a.jsx)("h3",{className:"text-white group-hover:text-blue font-bold h5",children:d})]})]}),(0,a.jsxs)("div",{className:"w-full flex flex-col justify-between gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"mb-5",children:["Add to ",s]}),(0,a.jsxs)("p",{className:"font-bold",children:["Please sign in or create an account to add this to your ",s,"."]})]}),(0,a.jsx)(c.Link,{href:"/sign_in",className:"Button w-fit",children:"Sign in"})]})]})]})})})})]})}},20942:function(e,t,l){l.d(t,{ClientSessionProvider:function(){return r},v:function(){return n}});var a=l(57437),o=l(2265),i=l(27526),c=l(99376);let s=(0,o.createContext)(null),r=e=>{let{children:t}=e,[l,r]=(0,o.useState)(null),[n,d]=(0,o.useState)(!0),u=null==l?void 0:l.user,f=(0,c.useSearchParams)();(0,o.useEffect)(()=>{("success"===f.get("logout")||"access_denied"===f.get("error"))&&r(null)},[f]);let m=async()=>{r(await (0,i.Gg)()),d(!1)};return(0,o.useEffect)(()=>{n&&!l&&m()},[]),(0,a.jsx)(s.Provider,{value:{session:l,loading:n,user:u,loadSession:m},children:t})},n=()=>(0,o.useContext)(s)},7189:function(e,t,l){l.d(t,{R:function(){return f},UserCollectionsProvider:function(){return m}});var a=l(57437),o=l(2265),i=l(99376),c=l(49914);l(83079);var s=l(12119),r=(0,s.$)("0039ee4086461d92d4caac6f029bb59a562f59db"),n=l(20942),d=(0,s.$)("92d4c2ba07b0f0fff339df314e89de233fb17caa"),u=l(76319);let f=(0,o.createContext)(null),m=e=>{let{children:t}=e,[l,s]=(0,o.useState)([]),[m,p]=(0,o.useState)(!1),[h,x]=(0,o.useState)(!1),{session:v,loading:g}=(0,n.v)(),b=null==v?void 0:v.user,y=(0,i.usePathname)().includes("/collections"),w=e=>e.map((e,t)=>({...e,unique_id:"".concat(t)})),j=async()=>{try{let e=await r();e&&(null==e||e.map(e=>{e.collectionData.resources=w(e.collectionData.resources)})),s(e||[])}catch(e){console.error("Failed to load collections:",e)}finally{p(!0)}},N=async()=>{let e=await D(l);s(await C(e)),x(!0)},D=async e=>{let t=e.flatMap(e=>{var t;return(null===(t=e.collectionData)||void 0===t?void 0:t.resources)||[]}).filter(e=>"Note"!==e.type).map(e=>e.id);return await d(t)},C=async e=>{let t=[...l];for(let l of t){var a;let t=!1;for(let o of(null===(a=l.collectionData)||void 0===a?void 0:a.resources)||[]){if("Note"===o.type)continue;let l=e.find(e=>e.id===o.id);if(!l)continue;let{cardImage:a,slug:i,title:s,description:r,__typename:n,context:d,category:u,embedType:f}=l;if((null==a?void 0:a.url)!==o.cardImage&&(o.cardImage=null==a?void 0:a.url,t=!0),s!==o.title&&(o.title=s,t=!0),d!==o.context&&(o.context=d,t=!0),"EmbedPageRecord"===n&&(o.context=f,t=!0),u!==o.category&&(o.category=u,t=!0),"GlossaryItemRecord"===n){(0,c.sY)(r)!==(0,c.sY)(o.glossaryDescription)&&(o.glossaryDescription=r,t=!0);let e="glossary/".concat(i);e!==o.slug&&(o.slug=e,t=!0)}else i!==o.slug&&(o.slug=i,t=!0)}t&&(0,u.Z)(l)}return t};(0,o.useEffect)(()=>{v&&!g&&j()},[v,g]),(0,o.useEffect)(()=>{m&&y&&!h&&N()},[m,y]);let _=e=>{e&&(0,u.Z)(e),s(l.map(t=>t.id===e.id?e:t))};return(0,a.jsx)(f.Provider,{value:{user:b,collections:l,setCollections:s,collectionsLoaded:m,updateCollection:_,updateCollectionData:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=e.collectionData;_({...e,collectionData:{...l,...t}})}},children:t})}},90412:function(e,t,l){l.d(t,{Z:function(){return a}});async function a(e,t,l,a,o,i){let c;let s=e.length;o&&(c={title:"Copy of ".concat(o.collectionData.title),private:o.collectionData.private,collaborators:[{id:t.id,name:t.name,email:t.email}],resources:o.collectionData.resources});let r={owners:[t.email],collectionData:o?c:{title:"New collection ".concat(s+1),private:!0,collaborators:[{id:t.id,name:t.name,email:t.email}],resources:[]},sharedToken:""};if(a){var n;r.collectionData.resources.push({title:a.title,id:a.id,type:a.__typename,private:!1,slug:a.slug,note:"",cardImage:(null===(n=a.cardImage)||void 0===n?void 0:n.url)||"",glossaryDescription:"GlossaryItemRecord"===a.__typename?a.description:"",context:a.context})}else if(i)for(let e of i)r.collectionData.resources.push({title:e.title,id:e.id,type:e.__typename,private:!1,slug:e.slug,note:"",cardImage:"",glossaryDescription:e.description,context:e.context});else o||r.collectionData.resources.push({id:"1",type:"Note",title:"New Note",note:"",private:!1,unique_id:"1"});try{let t=await fetch("/api/collections/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(t.ok){console.log("Collection created");let a=await t.json(),o=[...e,a];return l(o),console.log("Response:",a),a}console.error("Failed to create collection")}catch(e){console.error("Error creating collection:",e)}}},63246:function(e,t,l){l.d(t,{vd:function(){return o}}),l(25566);let a=e=>e.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/^-+|-+$/g,""),o=e=>e?"/collections/".concat(e.id,"-").concat(a(e.collectionData.title)):"/collections"}}]);
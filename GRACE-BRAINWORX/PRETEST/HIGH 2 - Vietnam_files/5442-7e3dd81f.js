(self.webpackChunknatgeo=self.webpackChunknatgeo||[]).push([[5442],{64535:(e,t,n)=>{e.exports=n(91568)},67998:(e,t,n)=>{var a=n(50239).cbool;e.exports=function(e,t,n){var i=this;i.hideIfSignedUp=a(n),e&&(i.signUpSrc=e),t&&(i.campaignName=t)}},88635:(e,t,n)=>{e.exports=n(21098)},21098:(e,t,n)=>{var a=n(38416),i=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(67294);var o,l=n(3896),c=n(45697),p=n(50239),u=n(84967),m=n(5902),g=n(43881),d=n(359),h=n(83978),E=n(24660).getOneIDMetadataMap,f=n(26278),S=u.docScroll,b=n(34248).inject,y=n(35215),N=n(19495),v=f.getCountry,I=f.setEmailWallCookie,O=f.getEmailWallCookie,_=f.setNewsletterCookie,w=f.getNewsletterCookie,C=n(63105),k=n(84486),T=n(27361),A=n(64721),j=n(35161),M=d.COMMON_ANALYTICS.CUSTOM_EVENT,x=n(29426),L=n(67102),P=x.NEWSLETTER_NAME,U=x.NEWSLETTER_CODE.DEFAULT_CAMPAIGN_CODE,D=P.DEFAULT_CAMPAIGN,R=P.NATGEO_ALL_NEWSLETTERS,G=x.NEWSLETTER_EMITTERS.POLICY_BUILT,W=n(21800),V=p.emptyObj,F=p.emptyAry,Y=p.FALSE,B=p.TRUE,q=p.NULL,z="",H=p.cbool,J=p.empty,K=p.first,Q=p.noop,X=u.evtCancel,Z=N.loc,$="context.guest.disneyInstance",ee={INVALID_LOCATION:"Sorry, this campaign is not available in your area",ALREADY_OPT_IN:"This email is already subscribed"},te="guest_updated",ne="li",ae="props.campaignName",ie="props.signUpSrc",se="privacyCopy",re="context.analytics.track",oe="EmailStickyFooterTile",le="EmailInlineTile",ce="inline",pe=T(L,"PROP_NAMES.CAMPAIGN_CODE"),ue="mrktngMeta.".concat(pe),me="roadblock",ge="collapsible",de=["home","hub"];e.exports=function(e,t){var n=e.displayName||z,a="".concat("WithOneIdNewsletter").concat(n),s=t||V,u=s.campaignName||D,d=s.signUpSrc||"Natgeo Newsletter signup",f=s.hideIfSignedUp||Y;function N(e,t,n,a){var i=this;i.campaignId=e,i.email=t,i.marketing=n,i.legal=a}return(o=l({componentDidMount:function(){var e=this,t=(e.state||V).isInternational,n=T(e,ae,u),a=T(e,$);H(w(n))?e.setState({hasSignedUp:B}):e.setState({hasSignedUp:Y}),t||(J(a)?(m.once(te,e.getOneIdNewsletters),m.on(te,e.updateGuestEmail)):(e.getOneIdNewsletters(),e.updateGuestEmail()))},componentWillUnmount:function(){m.off(te,this.getOneIdNewsletters)},displayName:a,getInitialState:function(){var e=(this.props||V).closeableGeos,t=v(),n=A(e,t)||Y;return{email:V,emailIsValid:Y,emailSeen:{},formSuccess:Y,formError:z,inputError:Y,isInternational:"us"!==v(),isCollapsible:n,legal:F,marketing:F,policy:z,hasSignedUp:q}},getOneIdNewsletters:function(){var e=this,t=T(e,ae,u),n=T(e,$);J(n)||n.getInlineNewsletters(t).then(e.initMarketingState).catch((function(n){var a=n||V;"ALREADY_OPT_IN"===a.error_codes&&f&&(_(t),e.setState({hasSignedUp:B})),console.error(a)}))},handleEmailChange:function(e){var t=e||V,n=t.isValidEmail,a=(this.state||V).inputError,i=a&&n?Y:a;this.setState({email:t,inputError:i})},handleClose:function(){var e=T(this,"props.state.routing.params.pageType");!A(de,e)&&I(B)},initMarketingState:function(e){var t=this,n=((((t.props||V).state||V).routing||V).params||V).preselect||z,a=e.data||V,s=a.legal,r=(K(s)||V).content||z,o=a.marketing,l=T(t,ae,u)===R,c=j(o,(function(e){var t=e||V,a=t.code,i=t.content;return{code:a,subscribed:a===n||a===U?B:l?Y:B,content:i}})),p=function(e,t){var n=e||F,a=(K(n)||V).content||z,s=[];return n.length>1?(k(n,(function(e,t){var n=(e||V).content;n&&s.push(i.jsx(g,{text:n,element:ne},t))})),t&&s.push(i.jsx(g,{text:t,element:ne},se))):s.push(i.jsx(g,{text:"".concat(a," ").concat(t),element:ne},se)),s}(C(c,{subscribed:B}),r);m.emit(G,p,s,c),t.setState({legal:s,marketing:c,policy:p})},launchNewsletters:function(e){var t,n=this,a=n.props||V,i=(n.state||V).isCollapsible,s=a.cmsType,r=T(n,ae,u),o=T(n,re)||Q,l=T(n,$),c=e&&e.currentTarget,p=c&&c.parentNode,g=(S()||V).y;X(e),J(l)||(s===oe&&(t=T(a,ue,z),o(M,{event_name:"newsletter signup:modal opened",campaign_name:t,emailwall_type:i?ge:me})),l.on("opt-in",n.setSuccess),l.launchNewsletters(r),m.emit("natgeo_newsletters_open",c,p,g))},submit:function(e){var t,n=this,a=n.state||V,i=a.email||V,s=i.value,r=T(n,$,V),o=T(n,"props.mrktngMeta",V),l=T(n,ae,u),c=a.legal,p=a.marketing,m=C(p,{subscribed:B}),g=n.props||V,d=g.analytics,h=g.meta,f=(Z()||V).params;X(e),i.isValidEmail?J(r)||(t=new N(l,s,m,c),r.setInlineNewsletters(t,E(o,d,h,f)).then((function(e){n.setSuccess()})).catch((function(e){var t=(e||V).error_codes,a=ee[t]||"Sorry, sign up was not successful.";n.setState({formError:a})})).finally((function(){I(B)}))):n.setState({inputError:B})},render:function(){var t=this,n=t.state||V,a=n.email,s=n.formSuccess,o=n.formError,l=n.inputError,c=n.isInternational,p=n.isCollapsible,u=n.legal,m=n.marketing,g=n.policy,E=t.props||V,S=T(t,"context.guest.loggedIn"),b={event_name:"email wall impression",campaign_name:T(E,ue,z),signup_source:T(t,ie,d),emailwall_type:ce},y=O();return y&&!H(y)||n.hasSignedUp===Y||!f?i.jsx(h,{trackEvent:M,trackValues:b,children:i.jsx(e,r(r({},E),{},{email:a,formError:o,formSuccess:s,handleEmailChange:t.handleEmailChange,inputError:l,isInternational:c,isCollapsible:p,launchNewsletters:t.launchNewsletters,legal:u,loggedIn:S,marketing:m,policy:g,onClose:t.handleClose,submit:t.submit,onEnter:t.onEnter,updateMarketingItem:t.updateMarketingItem}))}):q},setSuccess:function(){var e,t,n=this,a=n.props||V,i=(n.state||V).isCollapsible,s=a.cmsType,r=T(n,ae,u),o=T(n,ie,d),l=T(n,re)||Q,c={event_name:"newsletter signup:success",signup_source:o},m=s===oe||s===le;f&&_(r),m&&(s===oe?t=i?ge:me:s===le&&(t=ce),e=T(a,ue,z),p.mix(c,{campaign_name:e,emailwall_type:t})),I(B),n.setState({formSuccess:B}),l(M,c)},updateGuestEmail:function(){var e=T(this,"context.guest",V),t=e.loggedIn,n=T(e,"profile.email"),a={};t&&n&&(a={value:n,isValidEmail:B},this.setState({email:a}))},updateMarketingItem:function(e,t){var n=(this.state||V).marketing||F,a=j(n,(function(n){var a=n||V;return a.code===e?W({},a,{subscribed:t}):a}));this.setState({marketing:a})},onEnter:function(e,t){var n=(this.state||V).emailSeen||V,a=t||V,i=T(e||V,ue,z),s=n[i]||Y;"inside"!==a.currentPosition||s||(n[i]=B,this.setState({emailSeen:n}))}})).contextTypes={analytics:c.object,guest:c.object},b("state")(y(o))}}}]);
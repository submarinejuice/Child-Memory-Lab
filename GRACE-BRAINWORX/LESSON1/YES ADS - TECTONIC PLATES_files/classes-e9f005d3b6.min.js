function TwinklGscClient(){function n(n,i){null!=i&&("client"in i&&a(i.client),"token"in i&&r(i.token),"enabled"in i&&c(i.enabled)),g!==!0&&(l(),null===e()&&u(),t(!0)),g=!0}function l(n){m=n!==!0?$(document):null}function t(l){l===!0?g!==!0&&(m.on("gscInit",n),m.on("gscPush",d)):(m.off("gscInit",null,n),m.off("gscPush",null,d))}function e(){return p.client.instance}function a(n){p.client.instance=n}function i(){var n=e();return null!=n&&"function"==typeof n.push&&"undefined"!=typeof n.loaded&&1===parseInt(n.loaded)}function u(n){return null!=n&&""!==String(n).trim()||(n=p.client.varName),p.client.instance=null!=window[n]?window[n]:null,p.client.instance}function r(n){"string"==typeof n&&0!==(n=n.trim()).length||(n=null),p.token=n}function o(){return p.client.api.push}function s(){return b}function c(n){b=n===!0}function d(n,l,t){if(!b)return null;null==t&&(t={});var a=null,u=t.triggerError===!0;try{Array.isArray(l)||(l=[]);var r=e(),s=i(),c=o(),d=c.reqId,f=d,p=c.status,g=1,m=[],w=t.ignoreInvalidApi===!0;3===p&&(m=c.items),null==r?g=3:s||(g=2);var y,v,k,I,E,q,A,P,C,G=l.length;for(y=0;y<G;y++)if(v=l[y],null!=v){if(Array.isArray(v))switch(v.length){case 3:k=v[0],I=v[1],E=v[2];break;case 2:k=v[0],E=v[1];break;default:E=null}else if("valueType"in v){if(!("api"in v)||null==(k=v.api))continue;if(!("value"in v)||null==(E=v.value))continue;switch(I=v.key||null,q=v.data||{},parseInt(v.valueType)){case 1:case 2:break;case 3:"function"!=typeof E&&(A=q.path||null,E=getVarFromPath(A||E,null,h));break;case 4:if("function"!=typeof E){if(A=q.path||null,null!=A&&null!=getVarFromPath(A,null,h)){E=null;break}try{_params=[].concat(E.args||[],E.body?[E.body]:[]),E=Function.constructor.apply(h,_params),E=null!=A?setVarFromPath(A,E,null,h):E}catch(F){E=null}}break;default:E=null}}if(null!==E){switch(P={id:null,data:null},k){case"targeting":case"user":case"callback":if(null==I)throw new Error("Invalid API key: "+I,500);P.data=[k,I,E];break;case"show":P.data=[k,E];break;default:if(!w)throw new Error("Unexpected API: "+k,500)}null!=P.data&&m.push(P)}else if(u)throw new Error("Unable to get value from call: "+(null!=v?JSON.stringify(v):"null"),500)}for(G=m.length,y=0;y<G;y++)P=m[y],C=null,null!=r&&(f=d,C=r.push(P.data),s?(P.id=C,d=C,null!=f&&clearTimeout(f)):(P.id=null,d=null));m.length>0&&(c.reqId=d,c.items=[2,3].indexOf(g)!==-1?c.items.concat(m):m,c.status=g,a={reqId:d,status:g,numReqs:m.length})}catch(F){if(u){var S="Unable to push GSC requests. Error: \n"+F.getMessage();throw new Error(S,500)}a=null}return a}function f(n,l){var t={action:"saveData",widget_id:n,data:l,url:window.location.href};$.post("/php/ajax/site-control.php",t)}var h=this,p={client:{varName:"_gscq",instance:null,api:{push:{reqId:null,items:[],status:0}}},token:null},g=!1,b=!0,m=null;return n(),h.onInit=n.bind(h),h.getGscClient=e.bind(h),h.setGscClient=a.bind(h),h.setGscClientFromDom=u.bind(h),h.hasLoadedGscClient=i.bind(h),h.getEnabled=s.bind(h),h.setEnabled=c.bind(h),h.push=d.bind(h),h.onWidgetSubmit=f.bind(h),h}